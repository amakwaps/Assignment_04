---
title: "Assignment_04"
author: "Priyasha Chawla and Beryl Nana Ama Akuffo-Kwapong"
date: "17/02/2022"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)

```

```{r include = FALSE}
def.chunk.hook  <- knitr::knit_hooks$get("chunk")
knitr::knit_hooks$set(chunk = function(x, options) {
  x <- def.chunk.hook(x, options)
  ifelse(options$size != "normalsize", paste0("\n \\", options$size,"\n\n", x, "\n\n \\normalsize"), x)
})

```

\begin{center}
\Huge{PPOL 670 | Assignment 04}

\Huge{Data Visualization, Markdown, and Git}
\end{center}

\vspace{0.1in}

```{r}
library(tidyverse)
library(ggplot2)
library(reshape2)
library(forcats)
library(dplyr)
library(plotly)
library(viridis)
library(hrbrthemes)
library(scales)

library(httr)
set_config(config(ssl_verifypeer = 0L))
library(readxl)

project <- read_excel("~/Desktop/Assignment_04/data/AIU All Women Dataset.xlsx")

```


```{r}
#Graph 3
#Groups per capita cost when all needs are met and current cost per capita by number of women in reproductive age and region
graph3 <- project %>%
  select(country = country, continent = region, wra = wra, cc_cost_per_capita = curr_costs_percap, cost_to_meet_all_needs_percapita = all_costs_percap) %>%
  group_by(continent) %>%
  mutate_if(is.numeric, round, 2)
#Creates a bar graph plotting per capita cost when all needs are met and current cost per capita by number of women in reproductive age and region
graph3 %>%
  ggplot(aes(x=cc_cost_per_capita, y=cost_to_meet_all_needs_percapita, size = wra, color = continent)) +
  geom_point(alpha=0.99) +
  labs(
    color ="Continents",
    title = "Total Current Cost Per Capita & Cost to Meet All Needs",
    subtitle = "This shows the cost structure in all five regions",
    caption = "Source: The Guttmacher Institute", 
    x = " Per Capita Cost to Meet All Needs", y = "Per Capita Current Cost",
  ) +
  scale_size_continuous(name = "Number of Women in Reproductive Age",
                        limits = c(1000, 100000),
                        range = c(0, 5)) 
```



Graph 3: Cost to meet all needs per capita and current cost per capita by number of women in reproductive age and region

In the case that interventions could reduce maternal deaths, we compare the current cost structures per capita(that is, how much is being spent on reproductive health care per person) with the cost structures if all needs (of contraceptive care, pregnancy, and new-born care) are met per person. Current per capita cost as well as cost when all needs are met are low for most countries in Europe and Asia. Interestingly, for most countries in Africa, the current cost per capita is on the higher end with some anomalies.
[Source: The Guttmacher Institute](osf.io/m85s9)